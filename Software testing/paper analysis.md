## What you see is what you test - augmenting software testing with computer vision(translate ver.)

### Abstract

软件测试的盲点是评估真实世界中被测系统的实际行为。在本文中，我们：

-  展示了如何使用计算机视觉中的方法和技术来克服软件测试对“网络世界”的固有限制。 它增强了常规软件测试的能力，并允许观察物理世界以及系统现实世界中的状态和事件。 
- 实施了一个演示方案，该方案演示了可视化测试自动化如何与计算机视觉技术结合使用，以在软件测试中包括对机电一体化系统物理特性的观察。 
- 该方法在实验室环境中的成功应用显示出一些好处和局限性。 我们讨论了这些好处和局限性，以突出显示行业设置中的潜在应用场景以及未来研究的途径。

### Introduction

软件密集型系统，网络物理系统和物联网将软件测试的前沿越来越多地推向了物理世界。 自主车辆，机器人，工业机械或医疗设备包括控制整个系统的“嵌入式”软件。 该软件产生的结果决定了系统物理表示的行为。 因此，物理组件的反应和状态被认为是测试系统时需要评估的相关输出。 实际上，这种测试通常是手动执行的，即由人工测试人员观察系统的行为。 这种“手动”或“可视”测试方法通常可以在系统级测试中找到，也可以在需要硬件和软件紧密交互的单个组件的测试中找到。

在本文中，我们展示了如何使用计算机视觉（CV）来克服软件测试对非物理“网络世界”的限制。 我们用摄像头代替了人类观察者，该摄像头可以根据观察到的场景的图形图像捕获系统的行为。 通过这种方式，CV可以通过对物理世界中状态和事件以及系统实际环境的观察来增强常规软件测试。

摄像机提供的反馈可以几种方式包含在测试中。 该测试可以使用CV技术来处理相机图像，例如，通过将提供的图像与参考图像进行比较。 视觉GUI测试中使用了类似的方法（即模板匹配），并已在诸如Sikuli [2]之类的工具中实现。 此外，CV库[3]为运动检测，对象识别和跟踪等提供了广泛的功能。“智能相机”（视觉传感器）已将这些功能集成在相机系统中。 它们仅将有关已识别对象及其位置和方向的预处理数据发送到测试系统，以减少通信开销。 可以将几个分布式智能相机组合到视觉传感器网络[4] [5]中，以形成灵活的监视和监视系统。

### Illustrative case study

为了评估CV将软件测试扩展到软件密集型系统的物理方面的可行性，我们实施了一个基于机电演示系统的说明性案例。图1显示了测试设置。 它的核心是一个微型工业生产系统，类似于一个“气动处理中心”，其中包括一个转盘，一个加工站，一个压缩机和一个带光栅的传送带。 由实时软件系统操作的具有行业实力的可编程逻辑控制器（PLC）控制生产系统。 数字量模拟量I/O模块将PLC连接到生产系统的传感器和执行器。 基于图形触摸面板的人机界面（HMI）允许操作员与系统进行交互，例如，启动和停止全自动处理。

该测试系统在带有两个连接的网络摄像机的标准笔记本电脑上运行，该摄像机监视生产系统的组件。 在经过测试的情况下（1）启动生产系统，（2）将工件放置在加工站中，在加工站中（3）处理工件，最后（4）将其运输到传送带的末端。 相应的测试用例已经使用开源工具SikuliX1的可视脚本语言进行了自动化。 该工具允许自动执行在计算机屏幕上可以观察到的所有操作。 它在屏幕上搜索预定义的模板图像，并执行各种交互操作，例如单击鼠标或键盘输入。 我们使用SikuliX的图像识别功能来监视所连接摄像机提供的视频输出。 测试脚本的检查点断言，视频的特定区域与预定义的参考图像相匹配，该图像显示了在给定的时间限制内成功处理了工件。

### Discussion

在下文中，我们讨论了在演示场景中实现的方法的优点和局限性。

A.好处

在真实环境中的真实测试场景。 物理世界中系统的行为受到仅在现实环境中存在的众多影响因素和条件的影响。 在理想的虚拟环境中进行测试可能不足以代表在这种情况下触发的所有缺陷。 但是，由于这些因素和条件的复杂性和无数的相互关系，通常无法对其进行全面的建模。 因此，测试通常是在真实或接近真实环境的真实条件下进行的。 在这种情况下，在测试中使用CV也会促进测试自动化。

视觉测试自动化类似于人类的感知。在系统级测试中，通常从最终用户的角度来指定预期的行为，即，根据用户可以感知的可观察到的结果。由于人类的感知是视觉的最重要意义，因此这些结果通常与视觉感知有关。手动测试通常以“所见即所得”的方式执行。因此，可以通过使用视觉增强的测试脚本语言和包含CV技术的工具来实现自动测试的自然方法。

上下文感知测试。在常规的自动测试中，决定测试是否通过的决定是将具体测量值与参考值进行比较的结果。这些比较是精确且可重复的，因为它们可以完全按照测试中定义的方式评估实际测量值。如果重复测试，则将评估相同的值-不会更少，也不会更多。在软件测试中包括来自物理世界的观察结果，可以拓宽测试的范围。特别是，它允许在进行评估时包括上下文信息，例如，检测违反系统约束或不变性的情况。此信息还可以帮助您识别由于干扰更改而导致测试结果无效的特殊情况。

支持调试和故障定位。 在测试执行期间监视系统可从不同角度提供有关测试期间系统行为的其他信息。 它提供了全面的视频文档，可跟踪整个测试过程，包括测试环境。 通过将此信息与测试执行中的步骤顺序相关联，可以注释不同的步骤，并确定影响测试结果的上下文因素。 该信息还是对测试结果进行后处理的宝贵支持，例如在调试和故障定位中。

B.局限性

观察但无动作。物理世界中的测试的两个主要方面是，一方面，观察系统的实际行为，另一方面，通过提供传感器数据（例如位置，加速度，冲击或温度）来触发系统活动。 CV技术在测试中的应用支持第一个方面，但自然不能解决为系统提供“物理输入”的挑战。在这种情况下，所提出的解决方案可以用作基于仿真传感器的硬件在环测试的测试设置的扩展[7]。这取决于被测试的特定系统，实际测试可以在多大程度上受益于CV，以及在何处需要进一步扩展。基于图像的观察的复杂性。在我们的说明性案例研究中，我们使用参考图像指定了成功完成工件加工所必须达到的系统状态。已经发现这种方法对于始终如一的可重复方案非常有效。但是，我们还发现，有些情况下要指定要复杂得多，例如，工件被卡住。人类观察者很容易诊断出这种异常情况。自动化诊断通常效率低下，因为它们的发生很少，并且每次出现的外观可能都不同。系统测试的鲁棒性和可维护性。对象识别的准确性受各种影响因素的影响，例如照明，相机分辨率和帧频，运动或遮挡。准确性低对自动化测试的健壮性有负面影响。 CV开发了许多技术来应对这些挑战。例如，可以通过将标记附加到观察到的组件来提高准确性和鲁棒性。此外，视觉传感器网络结合了来自摄像机阵列的数据，这些摄像机从不同角度观察同一场景。但是，这些解决方案也增加了自动化测试的复杂性，因此影响了实现工作及其可维护性[8]。

### Conclusions

提议的CV使用显示出将常规软件测试扩展到物理世界并提高测试的意识的巨大潜力。 在我们的说明性研究中，我们使用了视觉测试脚本来指定系统级的预期行为，而无需通过测试接口来拦截信号或访问内部状态。 它证明了该方法在实验室环境中的可行性。 我们计划将所描述的方法用于工业项目中的测试自动化，以进一步调查已发现的好处和局限性，并为将来的研究探索途径。